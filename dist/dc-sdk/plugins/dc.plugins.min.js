!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=1)}([function(e,t){e.exports="uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform float frequency;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  // From Stefan Gustavson's Procedural Textures in GLSL in OpenGL Insights\n  vec2 F = czm_cellular(materialInput.st * frequency);\n  float t = 1.0 - F.x * F.x;\n\n  vec4 color = mix(lightColor, darkColor, t);\n  material.diffuse = color.rgb;\n  material.alpha = color.a;\n\n  return material;\n}\n"},function(e,t,n){e.exports=n(2)},function(e,t,n){var r=function(e){if(!e)throw new Error("DC.Plugins: Missing DC Base SDK");e.init((function(){window.mapv&&(e.Namespace.mapv=window.mapv,delete window.mapv),n(27)}))};"undefined"!=typeof window&&window.DC&&r(DC),e.exports={install:r}},function(e,t){function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o={INITIALIZED:"initialized",ADDED:"added",REMOVED:"removed"};DC.LayerState=r({},o,{CLEARED:"cleared"}),DC.OverlayState=r({},o),DC.EffectState=r({},o),DC.WidgetState={INITIALIZED:"initialized",INSTALLED:"installed",ENABLED:"enabled",DISABLED:"disabled"},DC.RoamingState=r({},o)},function(e,t){e.exports="uniform vec4 color;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec4 fragColor = color;\n    fragColor = czm_gammaCorrect(fragColor);\n    material.emission = fragColor.rgb;\n    material.diffuse = fragColor.rgb;\n    material.alpha = color.a;\n    return material;\n}\n"},function(e,t){e.exports="uniform vec4 color;\nuniform float duration;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st;\n    float t =fract(czm_frameNumber / duration);\n    t *= 1.03;\n    float alpha = smoothstep(t- 0.03, t, st.s) * step(-t, -st.s);\n    alpha += 0.1;\n    material.diffuse = color.rgb;\n    material.alpha = alpha;\n    return material;\n}\n"},function(e,t){e.exports=" uniform sampler2D image;\n uniform float duration;\n uniform vec4 color;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n   czm_material material = czm_getDefaultMaterial(materialInput);\n   vec2 st = materialInput.st;\n   float time = fract(czm_frameNumber / duration);\n   vec4 colorImage = texture2D(image, vec2(fract(st.s - time), st.t));\n   material.alpha = colorImage.a * color.a;\n   material.diffuse = (colorImage.rgb + color.rgb)/2.0;\n   return material;\n}\n"},function(e,t){e.exports='/**\n * @license\n * Cellular noise ("Worley noise") in 2D in GLSL.\n * Copyright (c) Stefan Gustavson 2011-04-19. All rights reserved.\n * This code is released under the conditions of the MIT license.\n * See LICENSE file for details.\n */\n\n//#ifdef GL_OES_standard_derivatives\n//    #extension GL_OES_standard_derivatives : enable\n//#endif\n//\n//float aastep (float threshold , float value)\n//{\n//    float afwidth = 0.7 * length ( vec2 ( dFdx ( value ), dFdy ( value )));\n//    return smoothstep ( threshold - afwidth , threshold + afwidth , value );\n//}\n\n// Permutation polynomial: (34x^2 + x) mod 289\nvec3 _czm_permute289(vec3 x)\n{\n    return mod((34.0 * x + 1.0) * x, 289.0);\n}\n\n/**\n * DOC_TBA\n *\n * Implemented by Stefan Gustavson, and distributed under the MIT License.  {@link http://openglinsights.git.sourceforge.net/git/gitweb.cgi?p=openglinsights/openglinsights;a=tree;f=proceduraltextures}\n *\n * @name czm_cellular\n * @glslFunction\n *\n * @see Stefan Gustavson\'s chapter, <i>Procedural Textures in GLSL</i>, in <a href="http://www.openglinsights.com/">OpenGL Insights</a>.\n */\nvec2 czm_cellular(vec2 P)\n// Cellular noise, returning F1 and F2 in a vec2.\n// Standard 3x3 search window for good F1 and F2 values\n{\n#define K 0.142857142857 // 1/7\n#define Ko 0.428571428571 // 3/7\n#define jitter 1.0 // Less gives more regular pattern\n    vec2 Pi = mod(floor(P), 289.0);\n    vec2 Pf = fract(P);\n    vec3 oi = vec3(-1.0, 0.0, 1.0);\n    vec3 of = vec3(-0.5, 0.5, 1.5);\n    vec3 px = _czm_permute289(Pi.x + oi);\n    vec3 p = _czm_permute289(px.x + Pi.y + oi); // p11, p12, p13\n    vec3 ox = fract(p*K) - Ko;\n    vec3 oy = mod(floor(p*K),7.0)*K - Ko;\n    vec3 dx = Pf.x + 0.5 + jitter*ox;\n    vec3 dy = Pf.y - of + jitter*oy;\n    vec3 d1 = dx * dx + dy * dy; // d11, d12 and d13, squared\n    p = _czm_permute289(px.y + Pi.y + oi); // p21, p22, p23\n    ox = fract(p*K) - Ko;\n    oy = mod(floor(p*K),7.0)*K - Ko;\n    dx = Pf.x - 0.5 + jitter*ox;\n    dy = Pf.y - of + jitter*oy;\n    vec3 d2 = dx * dx + dy * dy; // d21, d22 and d23, squared\n    p = _czm_permute289(px.z + Pi.y + oi); // p31, p32, p33\n    ox = fract(p*K) - Ko;\n    oy = mod(floor(p*K),7.0)*K - Ko;\n    dx = Pf.x - 1.5 + jitter*ox;\n    dy = Pf.y - of + jitter*oy;\n    vec3 d3 = dx * dx + dy * dy; // d31, d32 and d33, squared\n    // Sort out the two smallest distances (F1, F2)\n    vec3 d1a = min(d1, d2);\n    d2 = max(d1, d2); // Swap to keep candidates for F2\n    d2 = min(d2, d3); // neither F1 nor F2 are now in d3\n    d1 = min(d1a, d2); // F1 is now in d1\n    d2 = max(d1a, d2); // Swap to keep candidates for F2\n    d1.xy = (d1.x < d1.y) ? d1.xy : d1.yx; // Swap if smaller\n    d1.xz = (d1.x < d1.z) ? d1.xz : d1.zx; // F1 is in d1.x\n    d1.yz = min(d1.yz, d2.yz); // F2 is now not in d2.yz\n    d1.y = min(d1.y, d1.z); // nor in  d1.z\n    d1.y = min(d1.y, d2.x); // F2 is in d1.y, we\'re done.\n    return sqrt(d1.xy);\n}\n'},function(e,t){e.exports='/**\n * @license\n * Description : Array and textureless GLSL 2D/3D/4D simplex\n *               noise functions.\n *      Author : Ian McEwan, Ashima Arts.\n *  Maintainer : ijm\n *     Lastmod : 20110822 (ijm)\n *     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n *               Distributed under the MIT License. See LICENSE file.\n *               https://github.com/ashima/webgl-noise\n */\n\nvec4 _czm_mod289(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 _czm_mod289(vec3 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 _czm_mod289(vec2 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nfloat _czm_mod289(float x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 _czm_permute(vec4 x)\n{\n    return _czm_mod289(((x*34.0)+1.0)*x);\n}\n\nvec3 _czm_permute(vec3 x)\n{\n    return _czm_mod289(((x*34.0)+1.0)*x);\n}\n\nfloat _czm_permute(float x)\n{\n    return _czm_mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 _czm_taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat _czm_taylorInvSqrt(float r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 _czm_grad4(float j, vec4 ip)\n{\n    const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n    vec4 p,s;\n\n    p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n    p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n    s = vec4(lessThan(p, vec4(0.0)));\n    p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\n\n    return p;\n}\n\n/**\n * DOC_TBA\n *\n * Implemented by Ian McEwan, Ashima Arts, and distributed under the MIT License.  {@link https://github.com/ashima/webgl-noise}\n *\n * @name czm_snoise\n * @glslFunction\n *\n * @see <a href="https://github.com/ashima/webgl-noise">https://github.com/ashima/webgl-noise</a>\n * @see Stefan Gustavson\'s paper <a href="http://www.itn.liu.se/~stegu/simplexnoise/simplexnoise.pdf">Simplex noise demystified</a>\n */\nfloat czm_snoise(vec2 v)\n{\n    const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                        0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                       -0.577350269189626,  // -1.0 + 2.0 * C.x\n                        0.024390243902439); // 1.0 / 41.0\n    // First corner\n    vec2 i  = floor(v + dot(v, C.yy) );\n    vec2 x0 = v -   i + dot(i, C.xx);\n\n    // Other corners\n    vec2 i1;\n    //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n    //i1.y = 1.0 - i1.x;\n    i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n    // x0 = x0 - 0.0 + 0.0 * C.xx ;\n    // x1 = x0 - i1 + 1.0 * C.xx ;\n    // x2 = x0 - 1.0 + 2.0 * C.xx ;\n    vec4 x12 = x0.xyxy + C.xxzz;\n    x12.xy -= i1;\n\n    // Permutations\n    i = _czm_mod289(i); // Avoid truncation effects in permutation\n    vec3 p = _czm_permute( _czm_permute( i.y + vec3(0.0, i1.y, 1.0 )) + i.x + vec3(0.0, i1.x, 1.0 ));\n\n    vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n    m = m*m ;\n    m = m*m ;\n\n    // Gradients: 41 points uniformly over a line, mapped onto a diamond.\n    // The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n    vec3 x = 2.0 * fract(p * C.www) - 1.0;\n    vec3 h = abs(x) - 0.5;\n    vec3 ox = floor(x + 0.5);\n    vec3 a0 = x - ox;\n\n    // Normalise gradients implicitly by scaling m\n    // Approximation of: m *= inversesqrt( a0*a0 + h*h );\n    m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n    // Compute final noise value at P\n    vec3 g;\n    g.x  = a0.x  * x0.x  + h.x  * x0.y;\n    g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n    return 130.0 * dot(m, g);\n}\n\nfloat czm_snoise(vec3 v)\n{\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n    // First corner\n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n    // Other corners\n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n\n    //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n    //   x1 = x0 - i1  + 1.0 * C.xxx;\n    //   x2 = x0 - i2  + 2.0 * C.xxx;\n    //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n    vec3 x1 = x0 - i1 + C.xxx;\n    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n    // Permutations\n    i = _czm_mod289(i);\n    vec4 p = _czm_permute( _czm_permute( _czm_permute(\n                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n    // Gradients: 7x7 points over a square, mapped onto an octahedron.\n    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n    float n_ = 0.142857142857; // 1.0/7.0\n    vec3  ns = n_ * D.wyz - D.xzx;\n\n    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n\n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n\n    //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n    //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n\n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n\n    //Normalise gradients\n    vec4 norm = _czm_taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n\n    // Mix final noise value\n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n}\n\nfloat czm_snoise(vec4 v)\n{\n    const vec4  C = vec4( 0.138196601125011,  // (5 - sqrt(5))/20  G4\n                          0.276393202250021,  // 2 * G4\n                          0.414589803375032,  // 3 * G4\n                         -0.447213595499958); // -1 + 4 * G4\n\n    // (sqrt(5) - 1)/4 = F4, used once below\n    #define F4 0.309016994374947451\n\n    // First corner\n    vec4 i  = floor(v + dot(v, vec4(F4)) );\n    vec4 x0 = v -   i + dot(i, C.xxxx);\n\n    // Other corners\n\n    // Rank sorting originally contributed by Bill Licea-Kane, AMD (formerly ATI)\n    vec4 i0;\n    vec3 isX = step( x0.yzw, x0.xxx );\n    vec3 isYZ = step( x0.zww, x0.yyz );\n    //  i0.x = dot( isX, vec3( 1.0 ) );\n    i0.x = isX.x + isX.y + isX.z;\n    i0.yzw = 1.0 - isX;\n    //  i0.y += dot( isYZ.xy, vec2( 1.0 ) );\n    i0.y += isYZ.x + isYZ.y;\n    i0.zw += 1.0 - isYZ.xy;\n    i0.z += isYZ.z;\n    i0.w += 1.0 - isYZ.z;\n\n    // i0 now contains the unique values 0,1,2,3 in each channel\n    vec4 i3 = clamp( i0, 0.0, 1.0 );\n    vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );\n    vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );\n\n    //  x0 = x0 - 0.0 + 0.0 * C.xxxx\n    //  x1 = x0 - i1  + 1.0 * C.xxxx\n    //  x2 = x0 - i2  + 2.0 * C.xxxx\n    //  x3 = x0 - i3  + 3.0 * C.xxxx\n    //  x4 = x0 - 1.0 + 4.0 * C.xxxx\n    vec4 x1 = x0 - i1 + C.xxxx;\n    vec4 x2 = x0 - i2 + C.yyyy;\n    vec4 x3 = x0 - i3 + C.zzzz;\n    vec4 x4 = x0 + C.wwww;\n\n    // Permutations\n    i = _czm_mod289(i);\n    float j0 = _czm_permute( _czm_permute( _czm_permute( _czm_permute(i.w) + i.z) + i.y) + i.x);\n    vec4 j1 = _czm_permute( _czm_permute( _czm_permute( _czm_permute (\n               i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))\n             + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))\n             + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))\n             + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));\n\n    // Gradients: 7x7x6 points over a cube, mapped onto a 4-cross polytope\n    // 7*7*6 = 294, which is close to the ring size 17*17 = 289.\n    vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n\n    vec4 p0 = _czm_grad4(j0,   ip);\n    vec4 p1 = _czm_grad4(j1.x, ip);\n    vec4 p2 = _czm_grad4(j1.y, ip);\n    vec4 p3 = _czm_grad4(j1.z, ip);\n    vec4 p4 = _czm_grad4(j1.w, ip);\n\n    // Normalise gradients\n    vec4 norm = _czm_taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    p4 *= _czm_taylorInvSqrt(dot(p4,p4));\n\n    // Mix contributions from the five corners\n    vec3 m0 = max(0.6 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0);\n    vec2 m1 = max(0.6 - vec2(dot(x3,x3), dot(x4,x4)            ), 0.0);\n    m0 = m0 * m0;\n    m1 = m1 * m1;\n    return 49.0 * ( dot(m0*m0, vec3( dot( p0, x0 ), dot( p1, x1 ), dot( p2, x2 )))\n                  + dot(m1*m1, vec2( dot( p3, x3 ), dot( p4, x4 ) ) ) ) ;\n}\n'},function(e,t){e.exports="uniform vec4 asphaltColor;\nuniform float bumpSize;\nuniform float roughness;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  // From Stefan Gustavson's Procedural Textures in GLSL in OpenGL Insights\n  //Main cellular pattern\n  vec4 color = asphaltColor;\n  vec2 st = materialInput.st;\n  vec2 F = czm_cellular(st / bumpSize);\n  color.rgb -= (F.x / F.y) * 0.1;\n\n  //Extra bumps for roughness\n  float noise = czm_snoise(st / bumpSize);\n  noise = pow(noise, 5.0) * roughness;\n  color.rgb += noise;\n\n  material.diffuse = color.rgb;\n  material.alpha = color.a;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 cementColor;\nuniform float grainScale;\nuniform float roughness;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  float noise = czm_snoise(materialInput.st / grainScale);\n  noise = pow(noise, 5.0) * roughness;\n\n  vec4 color = cementColor;\n  color.rgb += noise;\n\n  material.diffuse = color.rgb;\n  material.alpha = color.a;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 color;\nuniform float time;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  float alpha = 1.0;\n  if (time != 1.0)\n  {\n      float t = 0.5 + (0.5 * czm_snoise(materialInput.str / (1.0 / 10.0)));   // Scale [-1, 1] to [0, 1]\n\n      if (t > time)\n      {\n          alpha = 0.0;\n      }\n  }\n\n  material.diffuse = color.rgb;\n  material.alpha = color.a * alpha;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform float frequency;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  // From Stefan Gustavson's Procedural Textures in GLSL in OpenGL Insights\n  vec2 F = czm_cellular(materialInput.st * frequency);\n  float t = 0.1 + (F.y - F.x);\n\n  vec4 color = mix(lightColor, darkColor, t);\n  material.diffuse = color.rgb;\n  material.alpha = color.a;\n\n  return material;\n}\n"},function(e,t){e.exports="czm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  vec3 normalWC = normalize(czm_inverseViewRotation * material.normal);\n  vec3 positionWC = normalize(czm_inverseViewRotation * materialInput.positionToEyeEC);\n  float cosAngIncidence = max(dot(normalWC, positionWC), 0.0);\n\n  material.diffuse = mix(reflection.diffuse, refraction.diffuse, cosAngIncidence);\n\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 grassColor;\nuniform vec4 dirtColor;\nuniform float patchiness;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  vec2 st = materialInput.st;\n  float noise1 = (czm_snoise(st * patchiness * 1.0)) * 1.0;\n  float noise2 = (czm_snoise(st * patchiness * 2.0)) * 0.5;\n  float noise3 = (czm_snoise(st * patchiness * 4.0)) * 0.25;\n  float noise = sin(noise1 + noise2 + noise3) * 0.1;\n\n  vec4 color = mix(grassColor, dirtColor, noise);\n\n  //Make thatch patterns\n  float verticalNoise = czm_snoise(vec2(st.x * 100.0, st.y * 20.0)) * 0.02;\n  float horizontalNoise = czm_snoise(vec2(st.x * 20.0, st.y * 100.0)) * 0.02;\n  float stripeNoise = min(verticalNoise, horizontalNoise);\n\n  color.rgb += stripeNoise;\n\n  material.diffuse = color.rgb;\n  material.alpha = color.a;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform samplerCube cubeMap;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  vec3 normalWC = normalize(czm_inverseViewRotation * material.normal);\n  vec3 positionWC = normalize(czm_inverseViewRotation * materialInput.positionToEyeEC);\n  vec3 reflectedWC = reflect(positionWC, normalWC);\n  material.diffuse = textureCube(cubeMap, reflectedWC).channels;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform samplerCube cubeMap;\nuniform float indexOfRefractionRatio;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  vec3 normalWC = normalize(czm_inverseViewRotation * material.normal);\n  vec3 positionWC = normalize(czm_inverseViewRotation * materialInput.positionToEyeEC);\n  vec3 refractedWC = refract(positionWC, -normalWC, indexOfRefractionRatio);\n  material.diffuse = textureCube(cubeMap, refractedWC).channels;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform float frequency;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  vec3 scaled = materialInput.str * frequency;\n  float t = abs(czm_snoise(scaled));\n\n  vec4 color = mix(lightColor, darkColor, t);\n  material.diffuse = color.rgb;\n  material.alpha = color.a;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 lightWoodColor;\nuniform vec4 darkWoodColor;\nuniform float ringFrequency;\nuniform vec2 noiseScale;\nuniform float grainFrequency;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  //Based on wood shader from OpenGL Shading Language (3rd edition) pg. 455\n  vec2 st = materialInput.st;\n\n  vec2 noisevec;\n  noisevec.x = czm_snoise(st * noiseScale.x);\n  noisevec.y = czm_snoise(st * noiseScale.y);\n\n  vec2 location = st + noisevec;\n  float dist = sqrt(location.x * location.x + location.y * location.y);\n  dist *= ringFrequency;\n\n  float r = fract(dist + noisevec[0] + noisevec[1]) * 2.0;\n  if(r > 1.0)\n      r = 2.0 - r;\n\n  vec4 color = mix(lightWoodColor, darkWoodColor, r);\n\n  //streaks\n  r = abs(czm_snoise(vec2(st.x * grainFrequency, st.y * grainFrequency * 0.02))) * 0.2;\n  color.rgb += lightWoodColor.rgb * r;\n\n  material.diffuse = color.rgb;\n  material.alpha = color.a;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 color;\nuniform float duration;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  material.diffuse = 1.5 * color.rgb;\n  vec2 st = materialInput.st;\n  float dis = distance(st, vec2(0.5, 0.5));\n  float per = fract(czm_frameNumber / duration);\n  if(dis > per * 0.5){\n   discard;\n  }else {\n    material.alpha = color.a  * dis / per / 2.0;\n  }\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 color;\nuniform float duration;\nuniform float count;\nuniform float gradient;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  material.diffuse = 1.5 * color.rgb;\n  vec2 st = materialInput.st;\n  vec3 str = materialInput.str;\n  float dis = distance(st, vec2(0.5, 0.5));\n  float per = fract(czm_frameNumber / duration );\n  if(abs(str.z)>0.001){\n    discard;\n  }\n  if(dis >0.5){\n    discard;\n  }else {\n    float perDis = 0.5 / count;\n    float disNum;\n    float bl = .0;\n    for(int i=0;i<=10;i++){\n      if(float(i)<=count){\n        disNum = perDis*float(i) - dis + per/count;\n        if(disNum>0.0){\n          if(disNum<perDis){\n            bl = 1.0-disNum/perDis;\n          }else if(disNum-perDis<perDis){\n            bl = 1.0 - abs(1.0-disNum/perDis);\n          }\n          material.alpha = pow(bl,gradient);\n        }\n      }\n    }\n  }\n  return material;\n}\n\n"},function(e,t){e.exports="uniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nvarying vec2 v_textureCoordinates;\nuniform vec4 u_scanCenterEC;\nuniform vec3 u_scanPlaneNormalEC;\nuniform float u_radius;\nuniform vec4 u_scanColor;\n\nvec4 toEye(in vec2 uv, in float depth){\n  vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n  vec4 posInCamera = czm_inverseProjection * vec4(xy, depth, 1.0);\n  posInCamera =posInCamera / posInCamera.w;\n  return posInCamera;\n}\n\nvec3 pointProjectOnPlane(in vec3 planeNormal, in vec3 planeOrigin, in vec3 point){\n    vec3 v01 = point - planeOrigin;\n    float d = dot(planeNormal, v01) ;\n    return (point - planeNormal * d);\n}\n\nfloat getDepth(in vec4 depth){\n    float z_window = czm_unpackDepth(depth);\n    z_window = czm_reverseLogDepth(z_window);\n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n}\n\nvoid main(){\n    gl_FragColor = texture2D(colorTexture, v_textureCoordinates);\n    float depth = getDepth(texture2D(depthTexture, v_textureCoordinates));\n    vec4 viewPos = toEye(v_textureCoordinates, depth);\n    vec3 prjOnPlane = pointProjectOnPlane(u_scanPlaneNormalEC.xyz, u_scanCenterEC.xyz, viewPos.xyz);\n    float dis = length(prjOnPlane.xyz - u_scanCenterEC.xyz);\n    if(dis < u_radius){\n      float f = 1.0 - abs(u_radius - dis) / u_radius;\n      f = pow(f, 4.0);\n      gl_FragColor = mix(gl_FragColor, u_scanColor, f);\n    }\n  }\n"},function(e,t){e.exports="uniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nvarying vec2 v_textureCoordinates;\nuniform vec4 u_scanCenterEC;\nuniform vec3 u_scanPlaneNormalEC;\nuniform vec3 u_scanLineNormalEC;\nuniform float u_radius;\nuniform vec4 u_scanColor;\n\nvec4 toEye(in vec2 uv, in float depth){\n  vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n  vec4 posInCamera =czm_inverseProjection * vec4(xy, depth, 1.0);\n  posInCamera =posInCamera / posInCamera.w;\n  return posInCamera;\n}\n\nbool isPointOnLineRight(in vec3 ptOnLine, in vec3 lineNormal, in vec3 testPt){\n  vec3 v01 = testPt - ptOnLine;\n  normalize(v01);\n  vec3 temp = cross(v01, lineNormal);\n  float d = dot(temp, u_scanPlaneNormalEC);\n  return d > 0.5;\n}\n\nvec3 pointProjectOnPlane(in vec3 planeNormal, in vec3 planeOrigin, in vec3 point){\n  vec3 v01 = point -planeOrigin;\n  float d = dot(planeNormal, v01) ;\n  return (point - planeNormal * d);\n}\n\nfloat distancePointToLine(in vec3 ptOnLine, in vec3 lineNormal, in vec3 testPt){\n  vec3 tempPt = pointProjectOnPlane(lineNormal, ptOnLine, testPt);\n  return length(tempPt - ptOnLine);\n}\n\nfloat getDepth(in vec4 depth){\n  float z_window = czm_unpackDepth(depth);\n  z_window = czm_reverseLogDepth(z_window);\n  float n_range = czm_depthRange.near;\n  float f_range = czm_depthRange.far;\n  return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n}\n\nvoid main(){\n  gl_FragColor = texture2D(colorTexture, v_textureCoordinates);\n  float depth = getDepth( texture2D(depthTexture, v_textureCoordinates));\n  vec4 viewPos = toEye(v_textureCoordinates, depth);\n  vec3 prjOnPlane = pointProjectOnPlane(u_scanPlaneNormalEC.xyz, u_scanCenterEC.xyz, viewPos.xyz);\n  float dis = length(prjOnPlane.xyz - u_scanCenterEC.xyz);\n  float twou_radius = u_radius * 2.0;\n  if(dis < u_radius){\n      float f0 = 1.0 -abs(u_radius - dis) / u_radius;\n      f0 = pow(f0, 64.0);\n      vec3 lineEndPt = vec3(u_scanCenterEC.xyz) + u_scanLineNormalEC * u_radius;\n      float f = 0.0;\n      if(isPointOnLineRight(u_scanCenterEC.xyz, u_scanLineNormalEC.xyz, prjOnPlane.xyz)){\n          float dis1= length(prjOnPlane.xyz - lineEndPt);\n          f = abs(twou_radius -dis1) / twou_radius;\n          f = pow(f, 3.0);\n      }\n      gl_FragColor = mix(gl_FragColor, u_scanColor, f + f0);\n    }\n}\n"},function(e,t){e.exports="uniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nuniform float trength;\nuniform vec4 fogcolor;\nvarying vec2 v_textureCoordinates;\n\nvoid main(void){\n  vec4 origcolor = texture2D(colorTexture, v_textureCoordinates);\n  vec4 depthcolor = texture2D(depthTexture, v_textureCoordinates);\n  float f= clamp( trength * (depthcolor.r - 0.3 ) / 0.2, 0.0, 1.0);\n  gl_FragColor = mix(origcolor,fogcolor,f);\n}\n"},function(e,t){e.exports="uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\n\nfloat snow(vec2 uv,float scale){\n    float time = czm_frameNumber / 60.0;\n    float w=smoothstep(1.,0.,-uv.y*(scale/10.));\n    if(w<.1)return 0.;\n    uv+=time/scale;\n    uv.y+=time*2./scale;\n    uv.x+=sin(uv.y+time*.5)/scale;\n    uv*=scale;\n    vec2 s=floor(uv),f=fract(uv),p;\n    float k=3.,d;\n    p=.5+.35*sin(11.*fract(sin((s+p+scale)*mat2(7,3,6,5))*5.))-f;\n    d=length(p);\n    k=min(d,k);\n    k=smoothstep(0.,k,sin(f.x+f.y)*0.01);\n    return k*w;\n}\n\nvoid main(){\n    vec2 resolution = czm_viewport.zw;\n    vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\n    vec3 finalColor=vec3(0);\n    float c = 0.0;\n    c+=snow(uv,30.)*.0;\n    c+=snow(uv,20.)*.0;\n    c+=snow(uv,15.)*.0;\n    c+=snow(uv,10.);\n    c+=snow(uv,8.);\n    c+=snow(uv,6.);\n    c+=snow(uv,5.);\n    finalColor=(vec3(c));\n    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(finalColor,1), 0.3);\n\n}\n\n"},function(e,t){e.exports="uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\n\nfloat hash(float x){\n  return fract(sin(x*23.3)*13.13);\n}\n\nvoid main(){\n    float time = czm_frameNumber / 60.0;\n    vec2 resolution = czm_viewport.zw;\n    vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\n    vec3 c=vec3(.6,.7,.8);\n    float a=-.4;\n    float si=sin(a),co=cos(a);\n    uv*=mat2(co,-si,si,co);\n    uv*=length(uv+vec2(0,4.9))*.3+1.;\n    float v=1.-sin(hash(floor(uv.x*100.))*2.);\n    float b=clamp(abs(sin(20.*time*v+uv.y*(5./(2.+v))))-.95,0.,1.)*20.;\n    c*=v*b;\n    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(c,1), 0.5);\n}\n"},function(e,t,n){var r,i;!function(o,a,c){e.exports?e.exports=c():void 0===(i="function"==typeof(r=c)?r.call(t,n,t,e):r)||(e.exports=i)}(0,0,(function(){var e={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},t=function(){var t=function(e){this._coordinator={},this._data=[],this._radi=[],this._min=10,this._max=1,this._xField=e.xField||e.defaultXField,this._yField=e.yField||e.defaultYField,this._valueField=e.valueField||e.defaultValueField,e.radius&&(this._cfgRadius=e.radius)},n=e.defaultRadius;return t.prototype={_organiseData:function(e,t){var r=e[this._xField],i=e[this._yField],o=this._radi,a=this._data,c=this._max,s=this._min,l=e[this._valueField]||1,u=e.radius||this._cfgRadius||n;a[r]||(a[r]=[],o[r]=[]),a[r][i]?a[r][i]+=l:(a[r][i]=l,o[r][i]=u);var f=a[r][i];return f>c?(t?this.setDataMax(f):this._max=f,!1):f<s?(t?this.setDataMin(f):this._min=f,!1):{x:r,y:i,value:l,radius:u,min:s,max:c}},_unOrganizeData:function(){var e=[],t=this._data,n=this._radi;for(var r in t)for(var i in t[r])e.push({x:r,y:i,radius:n[r][i],value:t[r][i]});return{min:this._min,max:this._max,data:e}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(arguments[0].length>0)for(var e=arguments[0],t=e.length;t--;)this.addData.call(this,e[t]);else{var n=this._organiseData(arguments[0],!0);n&&(0===this._data.length&&(this._min=this._max=n.value),this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[n]}))}return this},setData:function(e){var t=e.data,n=t.length;this._data=[],this._radi=[];for(var r=0;r<n;r++)this._organiseData(t[r],!1);return this._max=e.max,this._min=e.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(e){return this._max=e,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(e){return this._min=e,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(e){this._coordinator=e},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},t}(),n=function(){var e=function(e){var t=e.gradient||e.defaultGradient,n=document.createElement("canvas"),r=n.getContext("2d");n.width=256,n.height=1;var i=r.createLinearGradient(0,0,256,1);for(var o in t)i.addColorStop(o,t[o]);return r.fillStyle=i,r.fillRect(0,0,256,1),r.getImageData(0,0,256,1).data},t=function(e,t){var n=document.createElement("canvas"),r=n.getContext("2d"),i=e,o=e;if(n.width=n.height=2*e,1==t)r.beginPath(),r.arc(i,o,e,0,2*Math.PI,!1),r.fillStyle="rgba(0,0,0,1)",r.fill();else{var a=r.createRadialGradient(i,o,e*t,i,o,e);a.addColorStop(0,"rgba(0,0,0,1)"),a.addColorStop(1,"rgba(0,0,0,0)"),r.fillStyle=a,r.fillRect(0,0,2*e,2*e)}return n};function n(t){var n=t.container,r=this.shadowCanvas=document.createElement("canvas"),i=this.canvas=t.canvas||document.createElement("canvas"),o=(this._renderBoundaries=[1e4,1e4,0,0],getComputedStyle(t.container)||{});i.className="heatmap-canvas",this._width=i.width=r.width=t.width||+o.width.replace(/px/,""),this._height=i.height=r.height=t.height||+o.height.replace(/px/,""),this.shadowCtx=r.getContext("2d"),this.ctx=i.getContext("2d"),i.style.cssText=r.style.cssText="position:absolute;left:0;top:0;",n.style.position="relative",n.appendChild(i),this._palette=e(t),this._templates={},this._setStyles(t)}return n.prototype={renderPartial:function(e){e.data.length>0&&(this._drawAlpha(e),this._colorize())},renderAll:function(e){this._clear(),e.data.length>0&&(this._drawAlpha(function(e){for(var t=[],n=e.min,r=e.max,i=e.radi,o=(e=e.data,Object.keys(e)),a=o.length;a--;)for(var c=o[a],s=Object.keys(e[c]),l=s.length;l--;){var u=s[l],f=e[c][u],p=i[c][u];t.push({x:c,y:u,value:f,radius:p})}return{min:n,max:r,data:t}}(e)),this._colorize())},_updateGradient:function(t){this._palette=e(t)},updateConfig:function(e){e.gradient&&this._updateGradient(e),this._setStyles(e)},setDimensions:function(e,t){this._width=e,this._height=t,this.canvas.width=this.shadowCanvas.width=e,this.canvas.height=this.shadowCanvas.height=t},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(e){this._blur=0==e.blur?0:e.blur||e.defaultBlur,e.backgroundColor&&(this.canvas.style.backgroundColor=e.backgroundColor),this._width=this.canvas.width=this.shadowCanvas.width=e.width||this._width,this._height=this.canvas.height=this.shadowCanvas.height=e.height||this._height,this._opacity=255*(e.opacity||0),this._maxOpacity=255*(e.maxOpacity||e.defaultMaxOpacity),this._minOpacity=255*(e.minOpacity||e.defaultMinOpacity),this._useGradientOpacity=!!e.useGradientOpacity},_drawAlpha:function(e){for(var n=this._min=e.min,r=this._max=e.max,i=(e=e.data||[]).length,o=1-this._blur;i--;){var a,c=e[i],s=c.x,l=c.y,u=c.radius,f=Math.min(c.value,r),p=s-u,h=l-u,d=this.shadowCtx;this._templates[u]?a=this._templates[u]:this._templates[u]=a=t(u,o);var y=(f-n)/(r-n);d.globalAlpha=y<.01?.01:y,d.drawImage(a,p,h),p<this._renderBoundaries[0]&&(this._renderBoundaries[0]=p),h<this._renderBoundaries[1]&&(this._renderBoundaries[1]=h),p+2*u>this._renderBoundaries[2]&&(this._renderBoundaries[2]=p+2*u),h+2*u>this._renderBoundaries[3]&&(this._renderBoundaries[3]=h+2*u)}},_colorize:function(){var e=this._renderBoundaries[0],t=this._renderBoundaries[1],n=this._renderBoundaries[2]-e,r=this._renderBoundaries[3]-t,i=this._width,o=this._height,a=this._opacity,c=this._maxOpacity,s=this._minOpacity,l=this._useGradientOpacity;e<0&&(e=0),t<0&&(t=0),e+n>i&&(n=i-e),t+r>o&&(r=o-t);for(var u=this.shadowCtx.getImageData(e,t,n,r),f=u.data,p=f.length,h=this._palette,d=3;d<p;d+=4){var y,m=f[d],_=4*m;if(_)y=a>0?a:m<c?m<s?s:m:c,f[d-3]=h[_],f[d-2]=h[_+1],f[d-1]=h[_+2],f[d]=l?h[_+3]:y}u.data=f,this.ctx.putImageData(u,e,t),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(e){var t=this.shadowCtx.getImageData(e.x,e.y,1,1).data[3],n=this._max,r=this._min;return Math.abs(n-r)*(t/255)>>0},getDataURL:function(){return this.canvas.toDataURL()}},n}(),r=function(){var t=!1;return"canvas2d"===e.defaultRenderer&&(t=n),t}(),i=function(){for(var e={},t=arguments.length,n=0;n<t;n++){var r=arguments[n];for(var i in r)e[i]=r[i]}return e},o=function(){var n=function(){function e(){this.cStore={}}return e.prototype={on:function(e,t,n){var r=this.cStore;r[e]||(r[e]=[]),r[e].push((function(e){return t.call(n,e)}))},emit:function(e,t){var n=this.cStore;if(n[e])for(var r=n[e].length,i=0;i<r;i++){(0,n[e][i])(t)}}},e}(),o=function(e){var t=e._renderer,n=e._coordinator,r=e._store;n.on("renderpartial",t.renderPartial,t),n.on("renderall",t.renderAll,t),n.on("extremachange",(function(t){e._config.onExtremaChange&&e._config.onExtremaChange({min:t.min,max:t.max,gradient:e._config.gradient||e._config.defaultGradient})})),r.setCoordinator(n)};function a(){var a=this._config=i(e,arguments[0]||{});if(this._coordinator=new n,a.plugin){var c=a.plugin;if(!e.plugins[c])throw new Error("Plugin '"+c+"' not found. Maybe it was not registered.");var s=e.plugins[c];this._renderer=new s.renderer(a),this._store=new s.store(a)}else this._renderer=new r(a),this._store=new t(a);o(this)}return a.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(e){return this._config=i(this._config,e),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(e){return this._store.getValueAt?this._store.getValueAt(e):this._renderer.getValueAt?this._renderer.getValueAt(e):null}},a}();return{create:function(e){return new o(e)},register:function(t,n){e.plugins[t]=n}}}))},function(e,t,n){"use strict";n.r(t);var r=DC.Namespace.Cesium;function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={ADD:"add",REMOVE:"remove"};DC.MouseEventType={CLICK:r.ScreenSpaceEventType.LEFT_CLICK,RIGHT_CLICK:r.ScreenSpaceEventType.RIGHT_CLICK,DB_CLICK:r.ScreenSpaceEventType.LEFT_DOUBLE_CLICK,MOUSE_MOVE:r.ScreenSpaceEventType.MOUSE_MOVE,WHEEL:r.ScreenSpaceEventType.WHEEL,MOUSE_OVER:"mouseover",MOUSE_OUT:"mouseout"},DC.ViewerEventType={ADD_LAYER:"addLayer",REMOVE_LAYER:"removeLayer",ADD_EFFECT:"addEffect",REMOVE_EFFECT:"removeEffect"},DC.SceneEventType={CAMERA_MOVE_END:"cameraMoveEnd",CAMERA_CHANGED:"cameraChanged",PRE_RENDER:"preRender",POST_RENDER:"postRender",MORPH_COMPLETE:"morphComplete",CLOCK_TICK:"clockTick"},DC.LayerEventType=o({},c,{CLEAR:"clear"}),DC.OverlayEventType=o({},c),DC.EffectEventType=o({},c),DC.RoamingEventType=o({},c,{TICK:"tick",ACTIVE:"active"});n(3);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}DC.LayerType=l({},DC.LayerType),DC.OverlayType=l({},DC.OverlayType),DC.EffectType=l({},DC.EffectType),DC.WidgetType=l({},DC.WidgetType),DC.GlobeRotate=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;f(this,e),this._viewer=t,this._time=r,this._callback=i,this._startRotate();var a=setTimeout((function(){n._endRotate(),n._callback&&n._callback.call(o||n),clearTimeout(a)}),1e3*Number(this._time))}var t,n,i;return t=e,(n=[{key:"_icrf",value:function(e,t){if(e.mode!==r.SceneMode.SCENE3D)return!1;var n=r.Transforms.computeIcrfToFixedMatrix(t);if(r.defined(n)){var i=this._viewer.camera,o=r.Cartesian3.clone(i.position),a=r.Matrix4.fromRotationTranslation(n);i.lookAtTransform(a,o)}}},{key:"_startRotate",value:function(){this._viewer.camera.lookAtTransform(r.Matrix4.IDENTITY),this._viewer.clock.multiplier=12e3,this._viewer.scene.postUpdate.addEventListener(this._icrf,this)}},{key:"_endRotate",value:function(){this._viewer.camera.lookAtTransform(r.Matrix4.IDENTITY),this._viewer.clock.multiplier=1,this._viewer.clock.currentTime=r.JulianDate.now().clone(),this._viewer.scene.postUpdate.removeEventListener(this._icrf,this)}}])&&p(t.prototype,n),i&&p(t,i),e}(),DC.AroundView=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(h(this,e),!(t&&t instanceof DC.Viewer))throw new Error("the viewer invalid");this._viewer=t,this._options=n,this._heading=t.camera.heading,this._startTime=r.JulianDate.fromDate(new Date),this._stopTime=r.JulianDate.addSeconds(this._startTime,this._options.duration||10,new r.JulianDate)}var t,n,i;return t=e,(n=[{key:"_start",value:function(){this._viewer.clock.currentTime=this._startTime.clone(),this._viewer.on(DC.SceneEventType.CLOCK_TICK,this._onTickHandler,this)}},{key:"_onTickHandler",value:function(){var e=r.JulianDate.secondsDifference(this._viewer.clock.currentTime,this._startTime),t=this._options.duration||10,n=r.Math.toRadians(e*(360/t))+this._heading;this._viewer.scene.camera.setView({orientation:{heading:n}}),r.JulianDate.compare(this._viewer.clock.currentTime,this._stopTime)>=0&&(this._viewer.off(DC.SceneEventType.CLOCK_TICK,this._onTickHandler,this),this._options.callback&&this._options.callback.call(this._options.context||this))}}])&&d(t.prototype,n),i&&d(t,i),e}(),DC.AroundPoint=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(y(this,e),!(n&&n instanceof DC.Position))throw new Error("the position invalid");this._viewer=t,this._position=n,this._options=i,this._heading=t.camera.heading,this._startTime=r.JulianDate.fromDate(new Date),this._stopTime=r.JulianDate.addSeconds(this._startTime,this._options.duration||10,new r.JulianDate)}var t,n,i;return t=e,(n=[{key:"_start",value:function(){this._viewer.clock.currentTime=this._startTime.clone(),this._viewer.on(DC.SceneEventType.CLOCK_TICK,this._onTickHandler,this)}},{key:"_onTickHandler",value:function(){var e=r.JulianDate.secondsDifference(this._viewer.clock.currentTime,this._startTime),t=this._options.duration||10,n=r.Math.toRadians(e*(360/t))+this._heading;this._viewer.scene.camera.setView({destination:DC.T.transformWGS84ToCartesian(this._position),orientation:{heading:n,pitch:r.Math.toRadians(this._options.pitch||0)}}),this._options.distance&&this._viewer.scene.camera.moveBackward(this._options.distance),r.JulianDate.compare(this._viewer.clock.currentTime,this._stopTime)>=0&&(this._viewer.off(DC.SceneEventType.CLOCK_TICK,this._onTickHandler,this),this._options.callback&&this._options.callback.call(this._options.context||this))}}])&&m(t.prototype,n),i&&m(t,i),e}();var _=n(4),v=n(5),g=n(6),b=n(7),C=n(8),x=n(9),w=n(0),D=n(0),O=n(10),E=n(11),z=n(12),P=n(13),S=n(14),T=n(15),M=n(16),A=n(17),k=n(18),j=n(19),I=n(20);function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r.ShaderSource._czmBuiltinsAndUniforms.czm_cellular=b,r.ShaderSource._czmBuiltinsAndUniforms.czm_snoise=C,r.Material.PolylineEmissionType="PolylineEmission",r.Material._materialCache.addMaterial(r.Material.PolylineEmissionType,{fabric:{type:r.Material.PolylineEmissionType,uniforms:{color:new r.Color(1,0,0,.7)},source:_},translucent:function(e){return!0}}),r.Material.PolylineFlowType="PolylineFlow",r.Material._materialCache.addMaterial(r.Material.PolylineFlowType,{fabric:{type:r.Material.PolylineFlowType,uniforms:{color:new r.Color(1,0,0,.7),duration:45},source:v},translucent:function(e){return!0}}),r.Material.PolylineTrailType="PolylineTrail",r.Material._materialCache.addMaterial(r.Material.PolylineTrailType,{fabric:{type:r.Material.PolylineTrailType,uniforms:{color:new r.Color(1,0,0,.7),image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAAgCAYAAABkS8DlAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAADSSURBVHja7NYxEoUgDEDBYM39z2qHtZViwMFxt1FJnF/98ZXWWkRE7LWWOOt5Lsm9q/vsbu9Zdtazs/J19O5bs1XPZrwze/6V31zxbOZs1n905Wt2p3f25GzE7ohv6q3nLQCA3xEAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAA8g4AAAD//wMA4WEFTJOT5UIAAAAASUVORK5CYII=",duration:45},source:g},translucent:function(e){return!0}}),r.Material.AsphaltType="Asphalt",r.Material._materialCache.addMaterial(r.Material.AsphaltType,{fabric:{type:r.Material.AsphaltType,uniforms:{asphaltColor:new r.Color(.15,.15,.15,1),bumpSize:.02,roughness:.2},source:x},translucent:function(e){return e.uniforms.asphaltColor.alpha<1}}),r.Material.BlobType="Blob",r.Material._materialCache.addMaterial(r.Material.BlobType,{fabric:{type:r.Material.BlobType,uniforms:{lightColor:new r.Color(1,1,1,.5),darkColor:new r.Color(0,0,1,.5),frequency:10},source:w},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<0}}),r.Material.BrickType="Brick",r.Material._materialCache.addMaterial(r.Material.BrickType,{fabric:{type:r.Material.BrickType,uniforms:{brickColor:new r.Color(.6,.3,.1,1),mortarColor:new r.Color(.8,.8,.7,1),brickSize:new r.Cartesian2(.3,.15),brickPct:new r.Cartesian2(.9,.85),brickRoughness:.2,mortarRoughness:.1},source:D},translucent:function(e){var t=e.uniforms;return t.brickColor.alpha<1||t.mortarColor.alpha<1}}),r.Material.CementType="Cement",r.Material._materialCache.addMaterial(r.Material.CementType,{fabric:{type:r.Material.CementType,uniforms:{cementColor:new r.Color(.95,.95,.85,1),grainScale:.01,roughness:.3},source:O},translucent:function(e){return e.uniforms.cementColor.alpha<1}}),r.Material.ErosionType="Erosion",r.Material._materialCache.addMaterial(r.Material.ErosionType,{fabric:{type:r.Material.ErosionType,uniforms:{color:new r.Color(1,0,0,.5),time:1},source:E},translucent:function(e){return e.uniforms.color.alpha<1}}),r.Material.FacetType="Facet",r.Material._materialCache.addMaterial(r.Material.FacetType,{fabric:{type:r.Material.FacetType,uniforms:{lightColor:new r.Color(.25,.25,.25,.75),darkColor:new r.Color(.75,.75,.75,.75),frequency:10},source:z},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<0}}),r.Material.FresnelType="Fresnel",r.Material._materialCache.addMaterial(r.Material.FresnelType,{fabric:{type:r.Material.FresnelType,materials:{reflection:{type:r.Material.ReflectionType},refraction:{type:r.Material.RefractionType}},source:P},translucent:!1}),r.Material.GrassType="Grass",r.Material._materialCache.addMaterial(r.Material.GrassType,{fabric:{type:r.Material.GrassType,uniforms:{grassColor:new r.Color(.25,.4,.1,1),dirtColor:new r.Color(.1,.1,.1,1),patchiness:1.5},source:S},translucent:function(e){var t=e.uniforms;return t.grassColor.alpha<1||t.dirtColor.alpha<1}}),r.Material.ReflectionType="Reflection",r.Material._materialCache.addMaterial(r.Material.ReflectionType,{fabric:{type:r.Material.ReflectionType,uniforms:{cubeMap:r.Material.DefaultCubeMapId,channels:"rgb"},source:T},translucent:!1}),r.Material.RefractionType="Refraction",r.Material._materialCache.addMaterial(r.Material.RefractionType,{fabric:{type:r.Material.RefractionType,uniforms:{cubeMap:r.Material.DefaultCubeMapId,channels:"rgb",indexOfRefractionRatio:.9},source:M},translucent:!1}),r.Material.TyeDyeType="TieDye",r.Material._materialCache.addMaterial(r.Material.TyeDyeType,{fabric:{type:r.Material.TyeDyeType,uniforms:{lightColor:new r.Color(1,1,0,.75),darkColor:new r.Color(1,0,0,.75),frequency:5},source:A},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<0}}),r.Material.WoodType="Wood",r.Material._materialCache.addMaterial(r.Material.WoodType,{fabric:{type:r.Material.WoodType,uniforms:{lightWoodColor:new r.Color(.6,.3,.1,1),darkWoodColor:new r.Color(.4,.2,.07,1),ringFrequency:3,noiseScale:new r.Cartesian2(.7,.5),grainFrequency:27},source:k},translucent:function(e){var t=e.uniforms;return t.lightWoodColor.alpha<1||t.darkWoodColor.alpha<1}}),r.Material.CircleFadeType="CircleFade",r.Material._materialCache.addMaterial(r.Material.CircleFadeType,{fabric:{type:r.Material.CircleFadeType,uniforms:{color:new r.Color(1,0,0,.7),duration:45},source:j},translucent:function(e){return!0}}),r.Material.CircleWaveType="CircleWave",r.Material._materialCache.addMaterial(r.Material.CircleWaveType,{fabric:{type:r.Material.CircleWaveType,uniforms:{color:new r.Color(1,0,0,.7),duration:45,count:1,gradient:.1},source:I},translucent:function(e){return!0}}),DC.PolylineTrailMaterialProperty=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._definitionChanged=new r.Event,this._color=void 0,this._colorSubscription=void 0,this._duration=void 0,this._durationSubscription=void 0,this.color=r.defaultValue(t.color,r.Color.fromBytes(0,255,255,255)),this.duration=r.defaultValue(t.duration,45)}var t,n,i;return t=e,(n=[{key:"getType",value:function(e){return r.Material.PolylineTrailType}},{key:"getValue",value:function(e,t){return t||(t={}),t.color=r.Property.getValueOrClonedDefault(this._color,e,r.Color.WHITE,t.color),t.duration=this._duration,t}},{key:"equals",value:function(e){return this===e||e instanceof DC.PolylineTrailMaterialProperty&&r.Property.equals(this._color,e._color)}},{key:"isConstant",get:function(){return!1}},{key:"definitionChanged",get:function(){return this._definitionChanged}}])&&R(t.prototype,n),i&&R(t,i),e}(),Object.defineProperties(DC.PolylineTrailMaterialProperty.prototype,{color:r.createPropertyDescriptor("color"),duration:r.createPropertyDescriptor("duration")}),DC.PolylineFlowMaterialProperty=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._definitionChanged=new r.Event,this._color=void 0,this._colorSubscription=void 0,this.color=r.defaultValue(t.color,r.Color.fromBytes(0,255,255,255)),this._duration=void 0,this._durationSubscription=void 0,this.duration=r.defaultValue(t.duration,45)}var t,n,i;return t=e,(n=[{key:"getType",value:function(e){return r.Material.PolylineFlowType}},{key:"getValue",value:function(e,t){return t||(t={}),t.color=r.Property.getValueOrClonedDefault(this._color,e,r.Color.WHITE,t.color),t.duration=this._duration,t}},{key:"equals",value:function(e){return this===e||e instanceof DC.PolylineFlowMaterialProperty&&r.Property.equals(this._color,e._color)}},{key:"isConstant",get:function(){return!1}},{key:"definitionChanged",get:function(){return this._definitionChanged}}])&&L(t.prototype,n),i&&L(t,i),e}(),Object.defineProperties(DC.PolylineFlowMaterialProperty.prototype,{color:r.createPropertyDescriptor("color"),duration:r.createPropertyDescriptor("duration")}),DC.PolylineEmissionMaterialProperty=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._definitionChanged=new r.Event,this._color=void 0,this._colorSubscription=void 0,this.color=r.defaultValue(t.color,new r.Color(1,0,0,.7))}var t,n,i;return t=e,(n=[{key:"getType",value:function(e){return r.Material.PolylineEmissionType}},{key:"getValue",value:function(e,t){return t||(t={}),t.color=r.Property.getValueOrUndefined(this._color,e),t}},{key:"equals",value:function(e){return this===e||e instanceof DC.PolylineEmissionMaterialProperty&&r.Property.equals(this._color,e._color)}},{key:"isConstant",get:function(){return!1}},{key:"definitionChanged",get:function(){return this._definitionChanged}}])&&F(t.prototype,n),i&&F(t,i),e}(),Object.defineProperties(DC.PolylineEmissionMaterialProperty.prototype,{color:r.createPropertyDescriptor("color")}),DC.WaterMaterialProperty=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._definitionChanged=new r.Event,this._baseWaterColor=void 0,this._baseWaterColorSubscription=void 0,this.baseWaterColor=r.defaultValue(t.baseWaterColor,new r.Color(.2,.3,.6,1)),this._blendColor=void 0,this._blendColorSubscription=void 0,this.blendColor=r.defaultValue(t.blendColor,new r.Color(0,1,.699,1)),this._specularMap=void 0,this._specularMapSubscription=void 0,this.specularMap=r.defaultValue(t.specularMap,r.Material.DefaultImageId),this._normalMap=void 0,this._normalMapSubscription=void 0,this.normalMap=r.defaultValue(t.normalMap,r.Material.DefaultImageId),this.frequency=r.defaultValue(t.frequency,10),this.animationSpeed=r.defaultValue(t.animationSpeed,.01),this.amplitude=r.defaultValue(t.amplitude,1),this.specularIntensity=r.defaultValue(t.specularIntensity,.5),this.fadeFactor=r.defaultValue(t.fadeFactor,1)}var t,n,i;return t=e,(n=[{key:"getType",value:function(e){return r.Material.WaterType}},{key:"getValue",value:function(e,t){return t||(t={}),t.baseWaterColor=r.Property.getValueOrUndefined(this._baseWaterColor,e),t.blendColor=r.Property.getValueOrUndefined(this._blendColor,e),t.specularMap=r.Property.getValueOrUndefined(this._specularMap,e),t.normalMap=r.Property.getValueOrUndefined(this._normalMap,e),t.frequency=this.frequency,t.animationSpeed=this.animationSpeed,t.amplitude=this.amplitude,t.specularIntensity=this.specularIntensity,t.fadeFactor=this.fadeFactor,t}},{key:"equals",value:function(e){return this===e||e instanceof DC.WaterMaterialProperty&&r.Property.equals(this._baseWaterColor,e._baseWaterColor)}},{key:"isConstant",get:function(){return!1}},{key:"definitionChanged",get:function(){return this._definitionChanged}}])&&V(t.prototype,n),i&&V(t,i),e}(),Object.defineProperties(DC.WaterMaterialProperty.prototype,{baseWaterColor:r.createPropertyDescriptor("baseWaterColor"),blendColor:r.createPropertyDescriptor("blendColor"),specularMap:r.createPropertyDescriptor("specularMap"),normalMap:r.createPropertyDescriptor("normalMap")}),DC.RimLightingMaterialProperty=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._definitionChanged=new r.Event,this._color=void 0,this._colorSubscription=void 0,this.color=r.defaultValue(t.color,new r.Color(1,0,0,.7)),this._rimColor=void 0,this._rimColorSubscription=void 0,this.rimColor=r.defaultValue(t.rimColor,new r.Color(1,1,1,.4)),this._width=void 0,this._widthSubscription=void 0,this.width=r.defaultValue(t.width,.3)}var t,n,i;return t=e,(n=[{key:"getType",value:function(e){return r.Material.RimLightingType}},{key:"getValue",value:function(e,t){return t||(t={}),t.color=r.Property.getValueOrUndefined(this._color,e),t.rimColor=r.Property.getValueOrUndefined(this._rimColor,e),t.width=r.Property.getValueOrUndefined(this._width,e),t}},{key:"equals",value:function(e){return this===e||e instanceof DC.RimLightingMaterialProperty&&r.Property.equals(this._color,e._color)}},{key:"isConstant",get:function(){return!1}},{key:"definitionChanged",get:function(){return this._definitionChanged}}])&&B(t.prototype,n),i&&B(t,i),e}(),Object.defineProperties(DC.RimLightingMaterialProperty.prototype,{color:r.createPropertyDescriptor("color"),rimColor:r.createPropertyDescriptor("rimColor"),width:r.createPropertyDescriptor("width")}),DC.CircleFadeMaterialProperty=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._definitionChanged=new r.Event,this._color=void 0,this._colorSubscription=void 0,this._duration=void 0,this._durationSubscription=void 0,this.color=r.defaultValue(t.color,r.Color.fromBytes(0,255,255,255)),this.duration=r.defaultValue(t.duration,45)}var t,n,i;return t=e,(n=[{key:"getType",value:function(e){return r.Material.CircleFadeType}},{key:"getValue",value:function(e,t){return t||(t={}),t.color=r.Property.getValueOrUndefined(this._color,e),t.duration=this._duration,t}},{key:"equals",value:function(e){return this===e||e instanceof DC.CircleFadeMaterialProperty&&r.Property.equals(this._color,e._color)}},{key:"isConstant",get:function(){return!1}},{key:"definitionChanged",get:function(){return this._definitionChanged}}])&&N(t.prototype,n),i&&N(t,i),e}(),Object.defineProperties(DC.CircleFadeMaterialProperty.prototype,{color:r.createPropertyDescriptor("color"),duration:r.createPropertyDescriptor("duration")}),DC.CircleWaveMaterialProperty=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._definitionChanged=new r.Event,this._color=void 0,this._colorSubscription=void 0,this._duration=void 0,this._durationSubscription=void 0,this.color=r.defaultValue(t.color,r.Color.fromBytes(0,255,255,255)),this.duration=r.defaultValue(t.duration,45),this.count=Math.max(r.defaultValue(t.count,2),1),this.gradient=r.defaultValue(t.gradient,.1),this.gradient<0?this.gradient=0:this.gradient>1&&(this.gradient=1)}var t,n,i;return t=e,(n=[{key:"getType",value:function(e){return r.Material.CircleWaveType}},{key:"getValue",value:function(e,t){return t||(t={}),t.color=r.Property.getValueOrUndefined(this._color,e),t.duration=this._duration,t.count=this.count,t.gradient=this.gradient,t}},{key:"equals",value:function(e){return this===e||e instanceof DC.CircleWaveMaterialProperty&&r.Property.equals(this._color,e._color)}},{key:"isConstant",get:function(){return!1}},{key:"definitionChanged",get:function(){return this._definitionChanged}}])&&W(t.prototype,n),i&&W(t,i),e}(),Object.defineProperties(DC.CircleWaveMaterialProperty.prototype,{color:r.createPropertyDescriptor("color"),duration:r.createPropertyDescriptor("duration")});var H=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._cache={},this._registerEvent()}var t,n,r;return t=e,(n=[{key:"_registerEvent",value:function(){}},{key:"_on",value:function(e,t,n){var r=this.getEvent(e),i=void 0;return t&&r&&(i=r.addEventListener(t,n||this)),i}},{key:"_off",value:function(e,t,n){var r=this.getEvent(e),i=!1;return r&&t&&(i=r.removeEventListener(t,n||this)),i}},{key:"_fire",value:function(e,t){var n=this.getEvent(e);n&&n.raiseEvent(t)}},{key:"on",value:function(e,t,n){return this._on(e,t,n)}},{key:"once",value:function(e,t,n){var r=this._on(e,t,n);r&&r()}},{key:"off",value:function(e,t,n){return this._off(e,t,n)}},{key:"fire",value:function(e,t){this._fire(e,t)}},{key:"getEvent",value:function(e){return this._cache[e]||void 0}}])&&G(t.prototype,n),r&&G(t,r),e}();function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(c,e);var t,n,i,o,a=(t=c,function(){var e,n=J(t);if(Y()){var r=J(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Z(this,e)});function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),a.call(this)}return n=c,(i=[{key:"_registerEvent",value:function(){var e=this;Object.keys(DC.LayerEventType).forEach((function(t){var n=DC.LayerEventType[t];e._cache[n]=new r.Event}))}}])&&K(n.prototype,i),o&&K(n,o),c}(H);function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ee(e,t){return(ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function te(e,t){return!t||"object"!==Q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ne(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function re(e){return(re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ee(e,t)}(c,e);var t,n,i,o,a=(t=c,function(){var e,n=re(t);if(ne()){var r=re(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return te(this,e)});function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),a.call(this)}return n=c,(i=[{key:"_registerEvent",value:function(){var e=this;Object.keys(DC.EffectEventType).forEach((function(t){var n=DC.EffectEventType[t];e._cache[n]=new r.Event}))}}])&&$(n.prototype,i),o&&$(n,o),c}(H);function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ae=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=t||DC.Util.uuid(),this._viewer=void 0,this._delegate=void 0,this._state=void 0,this._addable=!1,this._effectEvent=new ie,this.type=void 0,this.on(DC.EffectEventType.ADD,this._addHandler,this),this.on(DC.EffectEventType.REMOVE,this._removeHandler,this)}var t,n,r;return t=e,(n=[{key:"_mountedHook",value:function(){}},{key:"_addedHook",value:function(){}},{key:"_removedHook",value:function(){}},{key:"_addHandler",value:function(e){this._viewer=e,this._mountedHook&&this._mountedHook(),this._delegate&&this._addable&&this._viewer.delegate.scene.postProcessStages.add(this._delegate),this._addedHook&&this._addedHook(),this._state=DC.EffectState.ADDED}},{key:"_removeHandler",value:function(){this._viewer&&this._delegate&&this._addable&&(this._viewer.delegate.scene.postProcessStages.remove(this._delegate),this._delegate=void 0),this._removedHook&&this._removedHook(),this._state=DC.EffectState.REMOVED}},{key:"addTo",value:function(e){return e&&e.addEffect&&e.addEffect(this),this}},{key:"on",value:function(e,t,n){return this._effectEvent.on(e,t,n||this),this}},{key:"off",value:function(e,t,n){return this._effectEvent.off(e,t,n||this),this}},{key:"fire",value:function(e,t){return this._effectEvent.fire(e,t),this}},{key:"id",get:function(){return this._id}},{key:"effectEvent",get:function(){return this._effectEvent}}])&&oe(t.prototype,n),r&&oe(t,r),e}();function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ue(e,t){return!t||"object"!==ce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function me(e,t){return!t||"object"!==he(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _e(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function ve(e){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}DC.BloomEffect=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(a,e);var t,n,r,i,o=(t=a,function(){var e,n=pe(t);if(fe()){var r=pe(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return ue(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e))._contrast=128,t._brightness=-.3,t._glowOnly=!1,t._delta=1,t._sigma=2,t._stepSize=1,t._state=DC.EffectState.INITIALIZED,t.type=DC.EffectType.BLOOM,t}return n=a,(r=[{key:"_mountedHook",value:function(){this._delegate=this._viewer.delegate.scene.postProcessStages.bloom,this._delegate.enabled=!0,this.contrast=this._contrast,this.brightness=this._brightness,this.glowOnly=this._glowOnly,this.delta=this._delta,this.sigma=this._sigma,this.stepSize=this._stepSize}},{key:"_removedHook",value:function(){this._delegate&&(this._delegate.enabled=!1,this.delegate=void 0)}},{key:"contrast",set:function(e){this._contrast=e,this._delegate&&(this._delegate.uniforms.contrast=this._contrast)}},{key:"brightness",set:function(e){this._brightness=e,this._delegate&&(this._delegate.uniforms.brightness=this._brightness)}},{key:"glowOnly",set:function(e){this._glowOnly=e,this._delegate&&(this._delegate.uniforms.glowOnly=this._glowOnly)}},{key:"delta",set:function(e){this._delta=e,this._delegate&&(this._delegate.uniforms.delta=this._delta)}},{key:"sigma",set:function(e){this._sigma=e,this._delegate&&(this._delegate.uniforms.sigma=this._sigma)}},{key:"stepSize",set:function(e){this._stepSize=e,this._delegate&&(this._delegate.uniforms.stepSize=this._stepSize)}}])&&se(n.prototype,r),i&&se(n,i),a}(ae),DC.EffectType.BLOOM="bloom";var ge=n(21);function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xe(e,t){return(xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function we(e,t){return!t||"object"!==be(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function De(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Oe(e){return(Oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}DC.CircleScanEffect=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(c,e);var t,n,i,o,a=(t=c,function(){var e,n=ve(t);if(_e()){var r=ve(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return me(this,e)});function c(e,t,n,i,o){var s;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),!(t&&t instanceof DC.Position))throw new Error("the position invalid");return(s=a.call(this,e))._position=t,s._radius=n||0,s._color=r.defaultValue(i,r.Color.RED),s._duration=1e3*r.defaultValue(o,1),s._addable=!0,s._state=DC.EffectState.INITIALIZED,s.type=DC.EffectType.CIRCLE_SCAN,s}return n=c,(i=[{key:"_mountedHook",value:function(){var e=this,t=DC.T.transformWGS84ToCartesian(this._position),n=new r.Cartesian4(t.x,t.y,t.z,1),i=DC.T.transformWGS84ToCartesian(new DC.Position(this._position.lng,this._position.lat,this._position.alt+500)),o=new r.Cartesian4(i.x,i.y,i.z,1),a=(new Date).getTime();this._delegate=new r.PostProcessStage({name:this._id,fragmentShader:ge,uniforms:{u_scanCenterEC:function(){return r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,n,new r.Cartesian4)},u_scanPlaneNormalEC:function(){var t=r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,n,new r.Cartesian4),i=r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,o,new r.Cartesian4),a=new r.Cartesian3;return a.x=i.x-t.x,a.y=i.y-t.y,a.z=i.z-t.z,r.Cartesian3.normalize(a,a),a},u_radius:function(){return e._radius*(((new Date).getTime()-a)%e._duration)/e._duration},u_scanColor:this._color}})}}])&&de(n.prototype,i),o&&de(n,o),c}(ae),DC.EffectType.CIRCLE_SCAN="circleScan";var Ee=n(22);function ze(e){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Me(e,t){return!t||"object"!==ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ae(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}DC.RadarScanEffect=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xe(e,t)}(c,e);var t,n,i,o,a=(t=c,function(){var e,n=Oe(t);if(De()){var r=Oe(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return we(this,e)});function c(e,t,n,i,o){var s;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),!(t&&t instanceof DC.Position))throw new Error("the position invalid");return(s=a.call(this,e))._position=t,s._radius=n||0,s._color=r.defaultValue(i,r.Color.RED),s._duration=1e3*r.defaultValue(o,1),s._state=DC.EffectState.INITIALIZED,s._addable=!0,s.type=DC.EffectType.RADAR_SCAN,s}return n=c,(i=[{key:"_mountedHook",value:function(){var e=this,t=DC.T.transformWGS84ToCartesian(this._position),n=new r.Cartesian4(t.x,t.y,t.z,1),i=DC.T.transformWGS84ToCartesian(new DC.Position(this._position.lng,this._position.lat,this._position.alt+500)),o=new r.Cartesian4(i.x,i.y,i.z,1),a=DC.T.transformWGS84ToCartesian(new DC.Position(this._position.lng+.001,this._position.lat,this._position.alt)),c=new r.Cartesian4(a.x,a.y,a.z,1),s=(new Date).getTime(),l=new r.Quaternion,u=new r.Matrix3,f=new r.Cartesian4,p=new r.Cartesian4,h=new r.Cartesian4,d=new r.Cartesian3,y=new r.Cartesian3;this._delegate=new r.PostProcessStage({name:this._id,fragmentShader:Ee,uniforms:{u_scanCenterEC:function(){return r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,n,f)},u_scanPlaneNormalEC:function(){var t=r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,n,f),i=r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,o,p);return d.x=i.x-t.x,d.y=i.y-t.y,d.z=i.z-t.z,r.Cartesian3.normalize(d,d),d},u_scanLineNormalEC:function(){var t=r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,n,f),i=r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,o,p),a=r.Matrix4.multiplyByVector(viewer.camera._viewMatrix,c,h);d.x=i.x-t.x,d.y=i.y-t.y,d.z=i.z-t.z,r.Cartesian3.normalize(d,d),y.x=a.x-t.x,y.y=a.y-t.y,y.z=a.z-t.z;var m=((new Date).getTime()-s)%e._duration/e._duration;return r.Quaternion.fromAxisAngle(d,m*r.Math.PI*2,l),r.Matrix3.fromQuaternion(l,u),r.Matrix3.multiplyByVector(u,y,y),r.Cartesian3.normalize(y,y),y},u_radius:this._radius,u_scanColor:this._color}})}}])&&Ce(n.prototype,i),o&&Ce(n,o),c}(ae),DC.EffectType.RADAR_SCAN="radarScan";var je=n(23);function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fe(e,t){return!t||"object"!==Ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ve(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Be(e){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}DC.FogEffect=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(c,e);var t,n,i,o,a=(t=c,function(){var e,n=ke(t);if(Ae()){var r=ke(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Me(this,e)});function c(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Pe(this,c),(n=a.call(this,e))._trength=i||1,n._color=t||new r.Color(.8,.8,.8,.5),n._state=DC.EffectState.INITIALIZED,n._addable=!0,n.type=DC.EffectType.FOG,n}return n=c,(i=[{key:"_mountedHook",value:function(){var e=this;this._delegate=new r.PostProcessStage({name:this._id,fragmentShader:je,uniforms:{trength:function(){return e._trength},fogcolor:function(){return e._color}}})}}])&&Se(n.prototype,i),o&&Se(n,o),c}(ae),DC.EffectType.FOG="fog";var Ne=n(24);function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function He(e,t){return(He=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qe(e,t){return!t||"object"!==We(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ke(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}DC.SnowEffect=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Le(e,t)}(c,e);var t,n,i,o,a=(t=c,function(){var e,n=Be(t);if(Ve()){var r=Be(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Fe(this,e)});function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=a.call(this,e))._state=DC.EffectState.INITIALIZED,t._addable=!0,t.type=DC.EffectType.SNOW,t}return n=c,(i=[{key:"_mountedHook",value:function(){this._delegate=new r.PostProcessStage({name:this._id,fragmentShader:Ne})}}])&&Re(n.prototype,i),o&&Re(n,o),c}(ae),DC.EffectType.SNOW="snow";var Ze=n(25);function Ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}DC.RainEffect=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&He(e,t)}(c,e);var t,n,i,o,a=(t=c,function(){var e,n=Ue(t);if(Ke()){var r=Ue(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return qe(this,e)});function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=a.call(this,e))._state=DC.EffectState.INITIALIZED,t._addable=!0,t.type=DC.EffectType.RAIN,t}return n=c,(i=[{key:"_mountedHook",value:function(){this._delegate=new r.PostProcessStage({name:this._id,fragmentShader:Ze})}}])&&Ge(n.prototype,i),o&&Ge(n,o),c}(ae),DC.EffectType.RAIN="rain";var Je=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=t||DC.Util.uuid(),this._delegate=void 0,this._viewer=void 0,this._state=void 0,this._show=!0,this._cache={},this._attr={},this._style={},this._layerEvent=new X,this._layerEvent.on(DC.LayerEventType.ADD,this._addHandler,this),this._layerEvent.on(DC.LayerEventType.REMOVE,this._removeHandler,this),this.type=void 0}var t,n,i;return t=e,(n=[{key:"_addedHook",value:function(){}},{key:"_removedHook",value:function(){}},{key:"_addHandler",value:function(e){this._viewer=e,this._delegate instanceof r.PrimitiveCollection?this._viewer.scene.primitives.add(this._delegate):this._viewer.dataSources.add(this._delegate),this._addedHook&&this._addedHook(),this._state=DC.LayerState.ADDED}},{key:"_removeHandler",value:function(){if(!this._delegate)return!1;this._viewer&&(this._cache={},this._delegate instanceof r.PrimitiveCollection?(this._delegate.removeAll(),this._viewer.scene.primitives.remove(this._delegate)):this._delegate.then?(this._delegate.then((function(e){e.entities.removeAll()})),this._viewer.dataSources.remove(this._delegate)):(this._delegate.entities&&this._delegate.entities.removeAll(),this._viewer.dataSources.remove(this._delegate)),this._removedHook&&this._removedHook(),this._state=DC.LayerState.REMOVED)}},{key:"_addOverlay",value:function(e){e&&e.overlayEvent&&e.state!==DC.OverlayState.ADDED&&(e.overlayEvent.fire(DC.OverlayEventType.ADD,this),this._cache[e.overlayId]=e,this._state===DC.LayerState.CLEARED&&(this._state=DC.LayerState.ADDED))}},{key:"_removeOverlay",value:function(e){e&&e.overlayEvent&&e.state!==DC.OverlayState.REMOVED&&(e.overlayEvent.fire(DC.OverlayEventType.REMOVE,this),delete this._cache[e.overlayId])}},{key:"addOverlay",value:function(e){return this._addOverlay(e),this}},{key:"addOverlays",value:function(e){var t=this;return Array.isArray(e)&&e.forEach((function(e){t._addOverlay(overlay)})),this}},{key:"removeOverlay",value:function(e){return this._removeOverlay(e),this}},{key:"getOverlay",value:function(e){return this._cache[e]||void 0}},{key:"getOverlayById",value:function(e){var t=this,n=void 0;return Object.keys(this._cache).forEach((function(r){t._cache[r].id===e&&(n=t._cache[r])})),n}},{key:"getOverlaysByAttr",value:function(e,t){var n=this,r=[];return Object.keys(this._cache).forEach((function(i){n._cache[i].attr[e]===t&&r.push[n._cache[i]]})),r}},{key:"eachOverlay",value:function(e,t){var n=this;return Object.keys(this._cache).forEach((function(r){e&&e.call(t,n._cache[r])})),this}},{key:"getOverlays",value:function(){var e=this,t=[];return Object.keys(this._cache).forEach((function(n){t.push(e._cache[n])})),t}},{key:"clear",value:function(){}},{key:"remove",value:function(){this._viewer&&this._viewer.removeLayer(this)}},{key:"addTo",value:function(e){return e&&e.addLayer&&e.addLayer(this),this}},{key:"setStyle",value:function(e){}},{key:"show",set:function(e){this._show=e,this._delegate&&(this._delegate.show=this._show)},get:function(){return this._show}},{key:"layerEvent",get:function(){return this._layerEvent}},{key:"attr",set:function(e){this._attr=e},get:function(){return this._attr}},{key:"id",get:function(){return this._id}},{key:"delegate",get:function(){return this._delegate}},{key:"state",get:function(){return this._state}}])&&Ye(t.prototype,n),i&&Ye(t,i),e}();function Xe(e){return(Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tt(e,t){return(tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nt(e,t){return!t||"object"!==Xe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function it(e){return(it=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ot=n(26),at={maxOpacity:.8,minOpacity:.1,blur:.85,maxCanvasSize:2e3,minCanvasSize:700,radius:25,gradient:{.4:"blue",.6:"green",.8:"yellow",.9:"red"}};function ct(e){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){ut(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ht(e,t){return(ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dt(e,t){return!t||"object"!==ct(t)&&"function"!=typeof t?yt(e):t}function yt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _t(e){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}DC.HeatLayer=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tt(e,t)}(c,e);var t,n,i,o,a=(t=c,function(){var e,n=it(t);if(rt()){var r=it(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return nt(this,e)});function c(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(n=a.call(this,e))._options=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(n),!0).forEach((function(t){$e(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},at,{},t),n._heat=void 0,n._bounds=void 0,n._mBounds=void 0,n._scale=1,n._positions=[],n._options.spacing=1.5*n._options.radius,n._delegate=new r.CustomDataSource(e),n._entity=new r.Entity,n._state=DC.LayerState.INITIALIZED,n.type=DC.LayerType.HEAT,n}return n=c,(i=[{key:"_addedHook",value:function(){this._reDraw(),this._viewer.on(DC.SceneEventType.CAMERA_MOVE_END,this._reset,this)}},{key:"_removedHook",value:function(){this._viewer.off(DC.SceneEventType.CAMERA_MOVE_END,this._reset,this)}},{key:"_initContainer",value:function(){}},{key:"_transformWGS84ToHeatmap",value:function(e){e=DC.T.transformWGS84ToMercator(e);var t={};return t.x=Math.round((e.lng-this._mBounds.west)/this._scale+this._options.spacing),t.y=Math.round((e.lat-this._mBounds.south)/this._scale+this._options.spacing),t.y=this._heat._renderer.canvas.height-t.y,t}},{key:"_getMBounds",value:function(){var e=DC.T.transformWGS84ToMercator(new DC.Position(this._bounds.west,this._bounds.south)),t=DC.T.transformWGS84ToMercator(new DC.Position(this._bounds.east,this._bounds.north));return{west:e.lng,south:e.lat,east:t.lng,north:t.lat}}},{key:"_initCanvas",value:function(){var e=Math.abs(this._mBounds.east-this._mBounds.west),t=Math.abs(this._mBounds.north-this._mBounds.south),n=Math.max(e,t),r=Math.min(e,t),i=1;n>this._options.maxCanvasSize?r/(i=n/this._options.maxCanvasSize)<this._options.minCanvasSize&&(i=r/this._options.minCanvasSize):r<this._options.minCanvasSize&&n/(i=r/this._options.minCanvasSize)>this._options.maxCanvasSize&&(i=n/this._options.maxCanvasSize),this._scale=i,this._options.container||(this._options.container=DC.DomUtil.create("div","heat-map",document.getElementsByClassName("dc-container")[0])),this._options.container.style.cssText="\n    width:".concat(e/this._scale,"px;\n    height:").concat(t/this._scale,"px;\n    margin:0;\n    display:none"),this._heat?this._heat.configure(this._options):this._heat=ot.create(this._options)}},{key:"_initEntity",value:function(){var e=this._options.spacing*this._scale;this._mBounds.west-=e,this._mBounds.south-=e,this._mBounds.east+=e,this._mBounds.north+=e;var t=DC.T.transformMercatorToWGS84({lng:this._mBounds.west,lat:this._mBounds.south}),n=DC.T.transformMercatorToWGS84({lng:this._mBounds.east,lat:this._mBounds.north}),i=r.Rectangle.fromDegrees(t.lng,t.lat,n.lng,n.lat);this._entity.show=!1,this._entity.rectangle={coordinates:i,fill:!1,distanceDisplayCondition:this._options.distanceDisplayCondition},this._delegate.entities.add(this._entity)}},{key:"_reset",value:function(){var e=1e4/Math.floor(this._viewer.camera.positionCartographic.height)*60;e<10&&(e=10),e>60&&(e=60),this._options.radius=e,this._options.spacing=1.5*this._options.radius,this._heat&&this._heat.configure(this._options)}},{key:"_reDraw",value:function(){var e=this;if(!this._bounds)return!1;var t=this._getMBounds();this._mBounds&&t.west===this._mBounds.west&&t.south===this._mBounds.south&&t.east===this._mBounds.east&&t.north===this._mBounds.north||(this._mBounds=t,this._initCanvas());var n=[];this._positions.forEach((function(t){var r=e._transformWGS84ToHeatmap({lng:t.lng||t.x,lat:t.lat||t.y});n.push({x:r.x,y:r.y,value:t.value||1})})),this._heat.setData({min:0,max:1,data:n}),this._entity.rectangle||this._initEntity();var i=new r.ImageMaterialProperty({image:this._heat._renderer.canvas,transparent:!0});DC.Util.merge(this._entity.rectangle,{fill:!0,material:i}),this._entity.show=!0}},{key:"setPositions",value:function(e){return e&&Array.isArray(e)?(this._positions=e,this._bounds=DC.Math.bounds(this._positions),this._reDraw(),this):this}},{key:"addPosition",value:function(e){return this._positions.push(e),this._bounds=DC.Math.bounds(this._positions),this._reDraw(),this}},{key:"setOptions",value:function(e){return DC.Util.merge(this._options,e),this._heat&&(this._options.spacing=1.5*this._options.radius,this._heat.configure(this._options)),this}},{key:"options",get:function(){return this._options}}])&&et(n.prototype,i),o&&et(n,o),c}(Je),DC.LayerType.HEAT="heat";var vt={size:48,pixelRange:40,gradient:{1e-4:r.Color.BLUE.withAlpha(.5),.001:r.Color.GREEN.withAlpha(.5),.01:r.Color.ORANGE.withAlpha(.5),.1:r.Color.RED.withAlpha(.5)},fontSize:14,fontColor:r.Color.BLACK};function gt(e){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xt(e,t){return(xt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wt(e,t){return!t||"object"!==gt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Ot(e){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Et(e){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function St(e,t){return(St=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tt(e,t){return!t||"object"!==Et(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function At(e){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kt(e){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function It(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rt(e,t){return(Rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lt(e,t){return!t||"object"!==kt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ft(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Vt(e){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}DC.ClusterLayer=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ht(e,t)}(c,e);var t,n,i,o,a=(t=c,function(){var e,n=_t(t);if(mt()){var r=_t(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return dt(this,e)});function c(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ft(this,c),(t=a.call(this,e))._delegate=new r.CustomDataSource(e),t._options=lt({},vt,{},n),t._delegate.clustering.enabled=!0,t._delegate.clustering.clusterEvent.addEventListener(t._clusterEventHandler,yt(t)),t._circleCache={},t._delegate.clustering.pixelRange=t._options.pixelRange,t._state=DC.LayerState.INITIALIZED,t.type=DC.LayerType.CLUSTER,t}return n=c,(i=[{key:"_drawCircle",value:function(e){var t=e.toCssColorString(),n=this._options.size;if(!this._circleCache[t]){var r=document.createElement("canvas");r.width=n,r.height=n;var i=r.getContext("2d");i.save(),i.scale(n/24,n/24),i.fillStyle=e.withAlpha(.2).toCssColorString(),i.beginPath(),i.arc(12,12,12,0,2*Math.PI),i.closePath(),i.fill(),i.beginPath(),i.arc(12,12,9,0,2*Math.PI),i.fillStyle=e.toCssColorString(),i.fill(),i.closePath(),i.restore(),this._circleCache[t]=r.toDataURL()}return this._circleCache[t]}},{key:"_clusterEventHandler",value:function(e,t){if(!this._delegate.clustering.enabled)return!1;if(t.billboard.show=!0,t.label.font="bold ".concat(this._options.fontSize,"px sans-serif"),t.label.fillColor=this._options.fontColor,t.label.disableDepthTestDistance=Number.POSITIVE_INFINITY,this._delegate.entities.values.length){var n=this._delegate.entities.values.length||0;for(var i in this._options.gradient)if(e.length>=n*i){t.billboard.image=this._drawCircle(this._options.gradient[i]),t.label.show=!0;var o=String(e.length+",").length;t.label.pixelOffset=new r.Cartesian2(-this._options.size/this._options.fontSize*(o-1),6)}else e.length<=1&&(t.label.show=!1)}}},{key:"clear",value:function(){return this._delegate.entities.removeAll(),this._cache={},this._state=DC.LayerState.CLEARED,this}},{key:"enableCluster",set:function(e){this._delegate.clustering.enabled=e}}])&&pt(n.prototype,i),o&&pt(n,o),c}(Je),DC.LayerType.CLUSTER="cluster",DC.CzmlLayer=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xt(e,t)}(c,e);var t,n,i,o,a=(t=c,function(){var e,n=Ot(t);if(Dt()){var r=Ot(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return wt(this,e)});function c(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(bt(this,c),!t)throw new Error("the url is empty");return(n=a.call(this,e))._delegate=r.CzmlDataSource.load(t,i),n._state=DC.LayerState.INITIALIZED,n.type=DC.LayerType.CZML,n}return n=c,(i=[{key:"eachOverlay",value:function(e,t){if(this._delegate)return this._delegate.then((function(n){n.entities.values.forEach((function(n){e.call(t,n)}))})),this}},{key:"show",set:function(e){var t=this;this._show=e,this._delegate&&this._delegate.then((function(e){e.show=t._show}))},get:function(){return this._show}}])&&Ct(n.prototype,i),o&&Ct(n,o),c}(Je),DC.LayerType.CZML="czml",DC.KmlLayer=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&St(e,t)}(c,e);var t,n,i,o,a=(t=c,function(){var e,n=At(t);if(Mt()){var r=At(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Tt(this,e)});function c(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(zt(this,c),!t)throw new Error("the url is empty");return(n=a.call(this,e))._delegate=r.KmlDataSource.load(t,i),n._state=DC.LayerState.INITIALIZED,n.type=DC.LayerType.KML,n}return n=c,(i=[{key:"eachOverlay",value:function(e,t){if(this._delegate)return this._delegate.then((function(n){n.entities.values.forEach((function(n){e.call(t,n)}))})),this}},{key:"show",set:function(e){var t=this;this._show=e,this._delegate&&this._delegate.then((function(e){e.show=t._show}))},get:function(){return this._show}}])&&Pt(n.prototype,i),o&&Pt(n,o),c}(Je),DC.LayerType.KML="kml";var Bt=DC.Namespace.mapv;DC.MapvDataSet=Bt?Bt.DataSet:void 0,DC.MapvLayer=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rt(e,t)}(a,e);var t,n,r,i,o=(t=a,function(){var e,n=Vt(t);if(Ft()){var r=Vt(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Lt(this,e)});function a(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(jt(this,a),!Bt)throw new Error("miss mapv lib");return(t=o.call(this,e))._option=n,t._dataSet=void 0,t._delegate=void 0,t.type=DC.LayerType.MAPV,t}return n=a,(r=[{key:"_addHandler",value:function(e){this._viewer=e,this._delegate=new Bt.cesiumMapLayer(this._viewer.delegate,this._dataSet||new DC.MapvDataSet([]),this._option),e.delegate.scene.canvas.setAttribute("tabIndex",0),this._state=DC.LayerState.ADDED}},{key:"_removeHandler",value:function(){this._delegate&&this._delegate.remove(),this._state=DC.LayerState.REMOVED}},{key:"setDataSet",value:function(e){this._dataSet=e,this._delegate&&this._delegate.update({data:this._dataSet,option:this._option})}},{key:"show",set:function(e){this._show=e,this._delegate&&(this._show?this._delegate.show():this._delegate.hide())},get:function(){return this._show}}])&&It(n.prototype,r),i&&It(n,i),a}(Je),DC.LayerType.MAPV="mapv"}]);